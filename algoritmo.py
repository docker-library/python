Este es un nuevo algoritmo